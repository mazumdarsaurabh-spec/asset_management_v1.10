{% extends 'inventory/base.html' %}
{% load static %}
{% load widget_tweaks %}

{% block title %}{{ form_title }}{% endblock %}

{% block content %}
<div class="container-fluid mt-4">
    <div class="card shadow-lg p-4 w-100">
        <h2 class="card-title text-center mb-4">{{ form_title }}</h2>

        {% include 'inventory/messages.html' %}

        <hr>
        <h5 class="mt-4 mb-3">Item Details:</h5>
        <div class="table-responsive mb-4">
            <table class="table table-bordered table-striped table-hover w-100">
                <tbody>
                    <tr>
                        <th scope="row" style="width: 20%;">Item Name:</th>
                        <td>{{ item.item_name }}</td>
                    </tr>
                    <tr>
                        <th scope="row">UID No.:</th>
                        <td>{{ item.uid_no }}</td>
                    </tr>
                    <tr>
                        <th scope="row">Current Location:</th>
                        <td>{{ item.location.name|default:"N/A" }}</td>
                    </tr>
                    <tr>
                        <th scope="row">Current Project:</th>
                        <td>{{ item.project.name|default:"N/A" }}</td>
                    </tr>
                    <tr>
                        <th scope="row">Status:</th>
                        <td>{{ item.get_status_display }}</td>
                    </tr>
                </tbody>
            </table>
        </div>

        <form method="POST" class="needs-validation" novalidate>
            {% csrf_token %}
            <input type="hidden" name="item_uid_for_transfer" value="{{ item.uid_no }}">

            <h5 class="mb-3">Transfer Item:</h5>
            <div class="row">
                <div class="col-md-4 mb-3">
                    <label for="{{ transfer_form.new_location.id_for_label }}" class="form-label">New Location:</label>
                    {% render_field transfer_form.new_location class="form-control" %}
                    {% if transfer_form.new_location.errors %}<div class="text-danger small">{{ transfer_form.new_location.errors }}</div>{% endif %}
                </div>
                <div class="col-md-4 mb-3">
                    <label for="{{ transfer_form.new_project.id_for_label }}" class="form-label">New Project:</label>
                    {% render_field transfer_form.new_project class="form-control" %}
                    {% if transfer_form.new_project.errors %}<div class="text-danger small">{{ transfer_form.new_project.errors }}</div>{% endif %}
                </div>
                <div class="col-md-4 mb-3">
                    <label for="{{ transfer_form.transfer_date.id_for_label }}" class="form-label">Transfer Date:</label>
                    {% render_field transfer_form.transfer_date class="form-control" type="date" %}
                    {% if transfer_form.transfer_date.errors %}<div class="text-danger small">{{ transfer_form.transfer_date.errors }}</div>{% endif %}
                </div>
            </div>

            <div class="d-flex justify-content-between mt-4">
                <a href="{% url 'inventory:dashboard' %}" class="btn btn-secondary">Back to Dashboard</a>
                <button type="submit" name="transfer_submit" class="btn btn-info">Perform Transfer</button>
            </div>
        </form>
    </div>
</div>

<style>
    /* Force card & table to use full width */
    .card {
        width: 100% !important;
    }
    .table {
        width: 100% !important;
        font-size: 1rem; /* make text readable */
    }
</style>
{% endblock %}